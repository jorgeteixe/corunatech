---
import '../styles/components/EventCard.css'
export interface Props {
  slug: string
  title: string
  description: string
  date: Date
  endDate?: Date
  duration?: string
  location?: string
  rsvpLink?: string
  tags: string[]
  community: string
  communityName?: string
}

const {
  slug,
  title,
  description,
  date,
  endDate,
  duration,
  location,
  rsvpLink,
  tags,
  community,
  communityName
} = Astro.props

const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat('gl', {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  }).format(date)
}

const formatTime = (date: Date) => {
  return new Intl.DateTimeFormat('gl', {
    hour: '2-digit',
    minute: '2-digit'
  }).format(date)
}
---

<div class="event-card">
  <div class="event-card-content">
    <!-- Parte superior: header e informaci√≥n -->
    <div class="event-card-top">
      <!-- Header -->
      <div class="event-card-header">
        <div>
          <h3 class="event-card-title">{title}</h3>
          <p class="event-card-community">{communityName || community}</p>
        </div>
      </div>

      <!-- Date and Time -->
      <div class="event-card-details">
        <p class="event-card-detail">
          <span class="event-card-detail-icon">üìÖ</span>
          {formatDate(date)}
        </p>
        {
          duration && (
            <p class="event-card-detail">
              <span class="event-card-detail-icon">‚è±Ô∏è</span>
              Duraci√≥n: {duration}
            </p>
          )
        }
        {
          location && (
            <p class="event-card-detail">
              <span class="event-card-detail-icon">üìç</span>
              {location}
            </p>
          )
        }
      </div>
    </div>

    <!-- Parte media: descripci√≥n -->
    <div class="event-card-middle">
      <p class="event-card-description">{description}</p>
    </div>

    <!-- Parte inferior: tags y bot√≥n -->
    <div class="event-card-bottom">
      <!-- Tags -->
      <div class="event-card-tags">
        {tags.map(tag => <span class="event-card-tag">{tag}</span>)}
      </div>

      <!-- Footer - Mostrar bot√≥n solo si hay rsvpLink y la fecha es futura -->
      {
        rsvpLink && new Date(date) > new Date() && (
          <div class="event-card-footer">
            <a
              href={rsvpLink}
              target="_blank"
              rel="noopener noreferrer"
              class="event-card-rsvp-link"
            >
              Apuntarse ‚Üí
            </a>
          </div>
        )
      }
    </div>
  </div>
</div>
