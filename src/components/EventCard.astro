---
import '../styles/components/EventCard.css'
import { formatDate, isDateInFuture } from '../utils/date-utils'

interface Props {
  slug: string
  title: string
  description: string
  date: Date
  endDate?: Date
  duration?: string
  location?: string
  rsvpLink?: string
  tags: string[]
  community: string
  communityName?: string
}

const {
  slug,
  title,
  description,
  date,
  endDate,
  duration,
  location,
  rsvpLink,
  tags,
  community,
  communityName
} = Astro.props

const shouldShowRsvpButton = rsvpLink && isDateInFuture(date)
---

<div class="event-card">
  <div class="event-card-content">
    <!-- Parte superior: header e informaci√≥n -->
    <div class="event-card-top">
      <!-- Header -->
      <div class="event-card-header">
        <div>
          <h3 class="event-card-title">{title}</h3>
          <p class="event-card-community">{communityName || community}</p>
        </div>
      </div>

      <!-- Date and Time -->
      <div class="event-card-details">
        <p class="event-card-detail">
          <span class="event-card-detail-icon">üìÖ</span>
          {formatDate(date)}
        </p>
        {
          duration && (
            <p class="event-card-detail">
              <span class="event-card-detail-icon">‚è±Ô∏è</span>
              Duraci√≥n: {duration}
            </p>
          )
        }
        {
          location && (
            <p class="event-card-detail">
              <span class="event-card-detail-icon">üìç</span>
              {location}
            </p>
          )
        }
      </div>
    </div>

    <!-- Parte media: descripci√≥n -->
    <div class="event-card-middle">
      <p class="event-card-description">{description}</p>
    </div>

    <!-- Parte inferior: tags y bot√≥n -->
    <div class="event-card-bottom">
      <!-- Tags -->
      <div class="event-card-tags">
        {tags.map(tag => <span class="event-card-tag">{tag}</span>)}
      </div>

      {
        shouldShowRsvpButton && (
          <div class="event-card-footer">
            <a
              href={rsvpLink}
              target="_blank"
              rel="noopener noreferrer"
              class="event-card-rsvp-link"
            >
              Apuntarse ‚Üí
            </a>
          </div>
        )
      }
    </div>
  </div>
</div>
